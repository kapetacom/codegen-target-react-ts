kind: kapeta/block-type-frontend:1.3.4
metadata:
  name: kapeta/portal
spec:
  target:
    kind: kapeta/language-target-react-ts:local
  type: service
  providers:
    - kind: kapeta/resource-type-web-page:0.0.12
      metadata:
        name: MyPage
      spec:
        path: /
  consumers:
    - kind: kapeta/resource-type-redis:0.0.1
      metadata:
        name: session
    - kind: kapeta/resource-type-web-fragment:0.0.12
      metadata:
        name: subpage
      spec:
        path: /subpage
    - kind: kapeta/resource-type-rest-client:1.0.12
      metadata:
        name: tasks
      spec:
        methods:
          addTask:
            description: Add task for user
            method: POST
            path: /tasks/{userId}/{id}
            arguments:
              userId:
                type: string
                transport: path
              id:
                type: string
                transport: path
              filter:
                type: string
                transport: query
                optional: true
              task:
                ref: Task
                transport: body
            responseType:
              ref: Task
          markAsDone:
            description: Mark task as done
            method: POST
            path: /tasks/{id}/done
            arguments:
              id:
                type: string
                transport: path
              headers:
                ref: any
                transport: header
                optional: true
              metadata:
                transport: body
                ref: Map<string,string>
              tags:
                transport: query
                ref: Set<Tags>
                optional: true
          removeTask:
            description: Delete task
            method: DELETE
            path: /tasks/{id}
            arguments:
              id:
                type: string
                transport: path
  entities:
    types:
      - type: enum
        name: Tags
        description: null
        values:
          - TAG1
          - TAG2
      - type: enum
        name: TaskState
        description: null
        values:
          - PENDING
          - DONE
      - type: dto
        name: Task
        description: null
        properties:
          id:
            description: null
            type: string
            properties: null
            required: true
          state:
            description: null
            ref: TaskState
            properties: null
            required: true
          created:
            type: date
            required: false
          views:
            type: integer
            required: false
          stars:
            type: float
            required: false
          numberList:
            type: double[]
            required: true
          age:
            description: Age of the task
            type: integer
            required: true
          metadata:
            ref: Map<string,string>
            required: true
          tags:
            ref: Set<Tags>
            required: true
    source:
      type: kapeta-dsl
      value: |-
        enum TestState {
            OK,TWO
        }

        MyType {
            id:string

            state:TestState
        }
