//#FILENAME:src/server/index.ts:create-only
import { ConfigProvider, runApp } from "@kapeta/sdk-config";
import { createServer } from "./server";
{{#include-proxy-route}}
import { createRoutes } from "./.generated/routes";
{{/include-proxy-route}}
import Path from 'node:path';

const BASE_DIR = Path.resolve(__dirname, "../../dist");
runApp(async (configProvider:ConfigProvider) => {
    const server = await createServer(configProvider);
    {{#include-proxy-route}}
    server.use(await createRoutes(configProvider));
    {{/include-proxy-route}}
    const webpackConfig = require("../../webpack.development.config");
    server.configureAssets(BASE_DIR, webpackConfig);

    server.start("web");
}, Path.resolve(__dirname,'../../'));